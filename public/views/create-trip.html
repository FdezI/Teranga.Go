<link rel="import" href="trip.html">
<link rel="import" href="../elements/trip-table.html">
<!-- <link rel="import" href="../elements/trip-service.html"> -->
<link rel="import" href="../elements/route-service.html">

<link rel="import" href="../elements/car-container.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-slider/paper-slider.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">

<link rel="import" href="../elements/in-array-validator.html">

<dom-module name="create-trip">
  <style>
    :host {
      display: flex;
    }
    .create-trip-map {
      background: #369;
      width: 30%;
      margin: 10px 2% 10px 0px;
      height: 200px;
      align-self: center;
      display: inline-block;
    }
    .create-trip-area {
      display: inline-block;
      width: 65%;
      min-width: 200px;
    }
    .create-trip-input {
      min-width: 160px;
      width: 27%;
      display: inline-block;
      margin-right: 10px;
    }
    .create-trip-input-extra {
      min-width: 50px;
      display: inline-block;
      width: 68%;
      padding: 10px 0 10px 1%;
    }
  </style>
  <template>
    <route-service id="rs" fetch="list" data="{{routes}}"></route-service>
    <!-- <route-service id="r2" fetch="{{rte}}" data="{{routes}}"></route-service> -->

    <datalist id="routes">
      <template is="dom-repeat" items="[[routes]]">
        <option id="[[index]]" value="[[item.name]]">
      </template>
    </datalist>

    <div class="create-trip-map">
      
    </div>

    <div class="create-trip-area">
      <div>
        <in-array-validator items="[[routes]]" attrib="name" ></in-array-validator>
        <paper-input label="Ruta" list="routes" value="{{fakefilters.route}}" validator="in-array-validator" auto-validate></paper-input>
      </div>

      <div>
        <paper-input class="create-trip-input" label="De:" placeholder="Salida" value="{{fakefilters.departure}}"></paper-input>
        <input class="create-trip-input-extra" type="text" placeholder="Direccion" value="{{fakefilters.arrival}}">
      </div>
      <div>
        <paper-input class="create-trip-input"  label="A:" placeholder="Llegada"></paper-input>
        <input class="create-trip-input-extra" type="text" placeholder="Direccion">
      </div>
      <div>
        <paper-input class="create-trip-input" label="Coche" readonly always-float-label on-keypress="showCarSelect" on-click="showCarSelect" value="[[idcar]]"></paper-input>
        <paper-slider class="create-trip-input" label="Asientos" always-float-label min="1" max="4" pin snaps editable></paper-slider>
      </div>
    </div>


    <paper-dialog id="car_select" with-backdrop>
      <car-container iduser="[[user.iduser]]" cars="[[user.cars]]" on-select="selectCar"></car-container>
    </paper-dialog>

  </template>

  <script>
    Polymer({
      is: "create-trip",
      properties: {
        user: Object,
        filters: Object,
        idcar: Number,
        routes: Array,
        fakefilters: {
          type: Object,
          value: {},
          readOnly: true
        }
      },
      ready: function() {
        console.log("create-trip ready!");
        this.$.rs.reload();
      },
      showCarSelect: function() {
        this.$.car_select.open();
      },
      hideCarSelect: function() {
        this.$.car_select.close();
      },
      selectCar: function(e, car) {
        this.idcar = car.idcar;
        this.hideCarSelect();
      }
    });
  </script>
</dom-module>