<link rel="import" href="trip.html">
<link rel="import" href="../elements/trip-table.html">
<link rel="import" href="../elements/data-service.html">

<dom-module name="trips-view">
  <style>
  </style>
  <template>
    <data-service id="ts" type="trips" fetch="all" filters="[[filters]]" data="{{trips}}"></data-service>
    <trip-table trips="{{trips}}" filters="{{filters}}" on-search="search" on-selected="tripSelected"></trip-table>
    <select value="{{selected::input}}">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
    </select>
    <trip-view idtrip="[[selected]]" user="{{session.user}}"></trip-view>
  </template>

  <script>
    Polymer({
      is: "trips-view",
      properties: {
        selected: {
          type: Number,
          value: 0,
          observer: 'selectedChanged'
        },
        route: {
          type: String,
          notify: true
        },
        filters: Object,
        session: Object
      },
      ready: function() {
        console.log("trips-view ready!");
      },

      selectedChanged: function() {
        console.log("CHANGED SELECTED");
      },

      search: function() {
        this.$.ts.reload();
      },

      tripSelected: function(e, trip) {
        this.set('selected', trip.idtrip);
      }
    });
  </script>
</dom-module>