<!--TODO modify to create profile-box so when loged-in show profile configurations and such things  -->

<!-- <link rel="import" href="../bower_components/polymer/polymer.html"> -->
<link rel="import" href="login-service.html">

<dom-module name="login-box">
  <style>
  </style>
  
  <template>
    <div class="container">
			<div id="card" class="card">
			  <template is="dom-if" if="[[session.user]]">
			    <section>
			      <p>Bienvenido, <span>{{session.user.nick}}<span></p>
			      <button class='toggle' on-click="onExit">Salir</button>
			    </section>
			  </template>
			  <!-- <template is="dom-if" if="[[!session.user]]"">
			    <login-service id="loginserv" session="{{session}}" data="{{data}}"></login-service>
			    <section class='back'>
			      <form>
							<h2>Register now!</h2>
							<p>
								<label for="account_email">E-mail</label>
								<input type='email' id="account_email" value="{{item.email::input}}">
							</p> <p>
								<label for="account_password">Password</label>
								<input type='password' id="account_password" value="{{item.password::input}}">
							</p> <p>
								<label for="account_password_confirmation">Confirm password</label>
								<input type='password' id="account_password_confirmation">
							</p><p>
								<button on-click="onRegister">Register</button>
							</p>
							<button class='toggle' on-click="onClick">Loguear</button>
		      	</form>
			    </section>
			    <section class='front'>
						<form>
							<h2>Enter site</h2>
							<p>
								<label for="user_email">E-mail</label>
								<input type='email' id="user_email" value="{{item.email::input}}">
							</p> <p>
								<label for="user_password">Password</label>
								<input type='password' id="user_password" value="{{item.password::input}}">
							</p> <p>
								<button on-click="onSubmit">Submit</button>
							</p>
							<button class='toggle' on-click="onClick">Registrar</button>
						</form>
					</section>
			  </template> -->
			</div>
  	</div>
  </template>
  <script>
		Polymer({
			is: "login-box",
			properties: {
				session: {
					type: Object,
					notify: true
				},
				item: {
					type: Object,
					value: {},
				},
				data: Object
			},

			observers: [
				'sessionUserChanged(session.user)'
			],

			ready: function() {
				console.log("login-box ready: " + this.session.user);
			},
			onClick: function() {
				event.preventDefault();
				event.stopPropagation();
			},
			onExit: function() {
				delete this.data;
				delete this.session.user;
				this.session = {};
			},
			onSubmit: function() {
				console.log("submit");
				event.preventDefault();
				event.stopPropagation();
				this.data = JSON.stringify(this.item);

				this.$$("login-service").auth();
			},
			onRegister: function() {
				event.preventDefault();
				event.stopPropagation();

				this.data = JSON.stringify(this.item);
				this.$$("login-service").register();
			},
			sessionUserChanged: function() {
				if(!this.session) this.session = {};
			}
		});
  </script>
</dom-module>
