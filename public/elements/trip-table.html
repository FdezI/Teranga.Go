<link rel="import" href="trip-list.html">

<dom-module name="trip-table">
  <style>
  .trip-table-img {
    width: 30px;
    height: 30px;
  }
  .trip-table-filters {
    display: flex;
    width: 100%;
  }
  .trip-table-right {
    margin-left: auto;
    /*margin-right: 30px;*/
  }
  .trip-table-header {
    border: 1px solid #ccc;
    padding: 10px;
    background: #ccc;
    border-radius: 6px 6px 0px 0px;
    margin-top: 20px;
  }
  </style>
  
  <template>
    <table>
      <tr>
        <td colspan="4">Encuentra el viaje que necesitas</td>
      </tr>
      <tr>
        <td>De: </td>
        <td><input type="text" placeholder="De" value="{{filters.origin::input}}"></td>
        <td>A: </td>
        <td> <input type="text" placeholder="A" value="{{filters.destination::input}}"></td>
        
      </tr>
      <tr>
        <td><button on-click="search">Buscar</button></td>
      <tr>
      <tr>
        <td colspan="4">Cuando lo necesitas</td>
      </tr>
      <tr>
        <td>Entre:  </td>
        <td><input type="date" placeholder="De" value="{{filters.from::input}}" min="[[today()]]"></td>
        <td>Y:  </td>
        <td><input type="date" placeholder="A" value="{{filters.to::input}}" min="[[today()]]"></td>
      </tr>
    </table>

    <div class="trip-table-header layout horizontal">
      <div class="layout vertical">
        <div>Viajes de <span>[[departure]]</span> a <span>[[arrival]]</span></div>

        <div class="trip-table-filters">
          <span>Ordenar por:</span>
          <select value="Precio descendente">
            <option>Precio ascendente</option>
            <option>Precio descendente</option>
            <option>Estrellas</option>
            <option>Fecha y hora</option>
          </select>
        </div>
      </div>

      <div class="trip-table-right">
        <button><img class="trip-table-img" src="../images/pet-allow.png"></button>

        <button><img class="trip-table-img" src="../images/package-allow.png"></button>
      </div>
    </div>

    <trip-list>
      <template is="dom-repeat" items="{{trips}}" as="trip">
        <trip-card  username="[[trip.driverName]]" score="3" cities="[[trip.cities]]"departure="[[trip.departure]]" arrival="[[trip.arrival]]" day="[[day(trip)]]" month="[[month(trip)]]" hour="[[time(trip)]]" seats="[[trip.free]]" price="[[trip.cost]]" pets="[[allow(trip.animals)]]" packages="[[allow(trip.packages)]]"></trip-card>
      </template>
    </trip-list>
  </template>

  <script>
  Polymer({
    is: "trip-table",
    properties: {
      image: String,
      trips: Object,
      filters: {
        type: Object,
        value: {},
        notify: true
      }
    },

    observers: ['fromChanged(filters.from)', 'toChanged(filters.to)'],

    day: function(trip) {
      return window.Polymer.day(trip.date);
    },
    month: function(trip) {
     return window.Polymer.month(trip.date);
    },
    time: function(trip) {
      return window.Polymer.time(trip.date);
    },
    search: function() {
      this.fire('search');
    },
    allow: function(attrib) {
      return attrib ? "allow" : ((attrib == false || attrib == 0) ? "deny" : "unknown");
    },
    fromChanged: function(from) {
      var to = this.filters.to;
      if(!to || from > to) this.set('filters.to', from);
    },
    toChanged: function(to) {
      var from = this.filters.from;
      if(!from || from > to) this.set('filters.from', to);
    },
    today: function() {
      return new Date().toISOString().substring(0, 10);
    }
  });
  </script>
</dom-module>